#include <stdio.h>
#include <time.h>

int main() {
    int a, b, reste, compteur = 0;
    int a_initial, b_initial;
    int swapped = 0; // Indicateur de permutation
    clock_t debut, fin;

    printf("=== Calcul du PGCD et coefficients de Bézout ===\n");

    // Lecture des nombres
    printf("Entrez le premier nombre : ");
    scanf("%d", &a);
    printf("Entrez le deuxième nombre : ");
    scanf("%d", &b);

    // Conserver les valeurs initiales
    a_initial = a;
    b_initial = b;

    // Variables pour l'algorithme étendu
    int x0 = 1, y0 = 0; // Coefficients pour a
    int x1 = 0, y1 = 1; // Coefficients pour b
    int q, temp;

    // S'assurer que a >= b pour l'algorithme
    if (a < b) {
        int temp_val = a;
        a = b;
        b = temp_val;
        swapped = 1; // Marquer la permutation
    }

    debut = clock();

    printf("\n Étapes du calcul du PGCD :\n");
    while (b != 0) {
        q = a / b;
        reste = a % b;
        printf("%d = %d * (%d) + %d\n", a, b, q, reste);

        // Calcul des coefficients de Bézout
        temp = x1;
        x1 = x0 - q * x1;
        x0 = temp;

        temp = y1;
        y1 = y0 - q * y1;
        y0 = temp;

        a = b;
        b = reste;
        compteur++;
    }

    fin = clock();

    printf("\n Résultat final :\n");
    printf("Le PGCD de %d et %d est : %d\n", a_initial, b_initial, a);
    
    // Ajuster l'affichage des coefficients selon la permutation
    if (swapped) {
        printf("Coefficients de Bézout : %d * %d + %d * %d = %d\n", 
               b_initial, x0, a_initial, y0, a);
        printf("Vérification : %d*%d + %d*%d = %d\n", 
               b_initial, x0, a_initial, y0, b_initial * x0 + a_initial * y0);
    } else {
        printf("Coefficients de Bézout : %d * %d + %d * %d = %d\n", 
               a_initial, x0, b_initial, y0, a);
        printf("Vérification : %d*%d + %d*%d = %d\n", 
               a_initial, x0, b_initial, y0, a_initial * x0 + b_initial * y0);
    }
    
    if (a == 1) {
        printf("➡ Les deux nombres sont premiers entre eux.\n");
    } else {
        printf("➡ Les deux nombres ne sont pas premiers entre eux.\n");
    }

    double temps = (double)(fin - debut) / CLOCKS_PER_SEC;

    printf("\n=== Statistiques ===\n");
    printf("Nombre d'opérations (divisions) effectuées : %d\n", compteur);
    printf("Temps d'exécution approximatif : %.6f secondes\n", temps);
    printf("Nombre de variables utilisées (stockage) : 14\n");

    return 0;
}
